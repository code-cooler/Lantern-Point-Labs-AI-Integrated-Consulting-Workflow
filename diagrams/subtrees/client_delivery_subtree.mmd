flowchart TD
    %% Client Engagement & Delivery Subtree
    
    %% Main node connecting back to main diagram
    mainFlow(["Back to Main Flow"]) -.-> clientDelivery[Client Engagement\n& Delivery]
    
    %% Detailed steps within Client Engagement phase (limited to ~5 nodes)
    clientDelivery --> presentationPrep[Presentation Preparation]
    presentationPrep --> deliveryRehearsals[Delivery Rehearsals]
    deliveryRehearsals --> clientPresentation[Client Presentation]
    
    %% AI Integration - Presentation Support
    clientPresentation --> aiPresentationSupport{AI Presentation Support}
    aiPresentationSupport --> clientFeedbackSession[Client Feedback Session]
    
    %% Client Feedback Loop
    clientFeedbackSession --> clientFeedback{Client Feedback?}
    clientFeedback -->|Requires Changes| incorporateFeedback[Incorporate\nClient Feedback]
    incorporateFeedback --> aiRevisionOptimizer[AI: Revision Optimization]
    aiRevisionOptimizer --> clientFeedbackSession
    
    %% Return to main flow
    clientFeedback -->|Approved| nextPhase(["Continue to Implementation Support or Retrospective"])
    
    %% Click interactions
    click mainFlow ""../index.html" "Return to main workflow" _blank"
    click nextPhase ""../index.html" "Continue to next phase" _blank"
    click aiPresentationSupport "#" "AI Presentation Support\n\nPurpose: Provide real-time Q&A assistance during client presentations\n\nPrompt example: 'Based on our recommendation to [X], what data supports this approach if the client asks about [specific concern]?'\n\nClick for more details" _self
    
    %% Detailed Styling and Classifications
    classDef phase fill:#f5f5f5,stroke:#333,stroke-width:1px;
    classDef subProcess fill:#fff8e1,stroke:#ff8f00,stroke-width:1px;
    classDef decision fill:#e1f5fe,stroke:#0277bd,stroke-width:1px;
    classDef aiDecision fill:#ede7f6,stroke:#4527a0,stroke-width:1px,stroke-dasharray: 5 2;
    classDef aiNode fill:#f3e5f5,stroke:#6a1b9a,stroke-width:1px,stroke-dasharray: 5 2;
    classDef navigation fill:#e8f5e9,stroke:#2e7d32,stroke-width:1px,stroke-dasharray: 3 3;
    
    %% Apply styles to nodes
    class clientDelivery phase;
    class presentationPrep,deliveryRehearsals,clientPresentation,clientFeedbackSession,incorporateFeedback subProcess;
    class clientFeedback decision;
    class aiPresentationSupport aiDecision;
    class aiRevisionOptimizer aiNode;
    class mainFlow,nextPhase navigation;
